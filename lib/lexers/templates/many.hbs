      {{#if @first}}
      (function () {
      {{else}}
    , (function () {
      {{/if}}
        var inputs = []

        {{#each characters}}
        inputs[{{charCode}}] = function () {
          currentState = {{targetState}}
          {{#if targetIsAccepted}}
          isMatched = true
          {{else}}
          isMatched = false
          {{/if}}
        }
        {{/each}}

        return function () {
          var t = inputs[input.charCodeAt(i)]

          if(t) {
            t()
          }
          else {
{{>fallbackPartial}}
          }
        };
      }())
